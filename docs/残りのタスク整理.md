# 残りのタスク整理

**最終更新**: LIFFアプリ動作確認完了時点（2025年11月）

---

## ✅ 完了したタスク

### インフラ構築
- ✅ AWSアカウント作成
- ✅ DynamoDBテーブル作成（UserStamps, StampMasters, Users）
- ✅ S3バケット作成（画像保存用）
- ✅ API Gateway REST API作成・CORS設定

### Lambda関数実装
- ✅ Lambda関数雛形作成（auth, stamps）
- ✅ DynamoDB接続実装（stamps関数）
- ✅ 環境変数設定
- ✅ IAM権限設定（DynamoDB読み取り）

---

## 📋 残りのタスク（優先順位順）

### 🔴 最優先（即座に実施）

#### 1. バックエンド実装の完成
- [ ] **stamps関数の動作確認・改善**
  - DynamoDB接続のテスト完了 ✅（実装済み）
  - エラーハンドリングの強化
  - レスポンス形式の統一

- [x] **auth関数の実装（LINE認証）**
  - LINE IDトークン検証ロジック（モック実装完了、本番実装は後回し）
  - ユーザー情報のDynamoDB保存 ✅
  - セッショントークン生成（簡易版） ✅
  - AWS Lambdaへのデプロイ完了 ✅
  - API Gateway統合完了 ✅

- [x] **award関数の作成**
  - スタンプ授与処理 ✅
  - 重複チェックロジック ✅
  - DynamoDB書き込み処理 ✅
  - AWS Lambdaへのデプロイ完了 ✅
  - API Gateway統合完了 ✅

#### 2. フロントエンド基本実装
- [x] **LIFFアプリの基本構造**
  - `index.html`（エントリーポイント） ✅
  - `js/app.js`（LIFF初期化、基本フロー） ✅
  - `js/api.js`（API呼び出しラッパー） ✅

- [x] **LINEログイン機能**
  - LIFF SDK初期化 ✅
  - IDトークン取得 ✅
  - 認証API呼び出し ✅
  - 動作確認完了 ✅

#### 3. AI処理実装（担当者D）
- [ ] **GPS検証関数の作成**
  - `lambda/gps-verify` 関数
  - Haversine公式による距離計算
  - 100m以内判定ロジック

- [ ] **画像認識関数の作成**
  - `lambda/image-recognize` 関数
  - Amazon Rekognition連携
  - 画像検証ロジック

---

### 🟡 高優先度（Week 2-3）

#### 4. API仕様の確定・ドキュメント化
- [ ] **API仕様書の作成**
  - エンドポイント一覧
  - リクエスト/レスポンス形式
  - エラーコード定義
  - 認証フロー図

- [ ] **データベーススキーマ詳細**
  - テーブル定義の詳細化
  - インデックス設計の確認
  - サンプルデータ準備

#### 5. フロントエンド画面実装
- [ ] **ホーム画面**
  - スタンプ収集状況表示
  - 進捗バー
  - 統計情報

- [ ] **GPSスタンプ画面**
  - 現在地取得
  - 距離表示
  - 到達判定UI

- [ ] **カメラスタンプ画面**
  - カメラ起動・撮影
  - プレビュー
  - アップロード処理

#### 6. 統合テスト
- [ ] **API統合テスト**
  - エンドツーエンドテスト
  - エラーハンドリングテスト
  - パフォーマンステスト

---

### 🟢 中優先度（Week 3-4）

#### 7. エラーハンドリング・ログ
- [ ] **標準エラーレスポンス**
  - エラーレスポンス形式の統一
  - エラーコード体系の確立

- [ ] **リトライロジック**
  - API呼び出しのリトライ
  - エクスポネンシャルバックオフ

#### 8. セキュリティ強化
- [ ] **認証トークンの管理**
  - セッショントークンの検証
  - トークンの有効期限管理

- [ ] **レート制限**
  - API呼び出し制限の実装
  - 不正利用対策

#### 9. デプロイ・運用準備
- [ ] **環境分離**
  - 開発/本番環境の分離方針決定
  - 環境ごとの設定管理

- [ ] **コスト監視**
  - 請求アラート設定
  - コスト最適化

---

### ⚪ 低優先度（Week 4以降）

#### 10. ドキュメント整備
- [ ] **環境構築マニュアル**
  - ローカル環境構築手順
  - AWSリソース作成手順
  - トラブルシューティング

- [ ] **開発ガイド**
  - コーディング規約
  - Git運用ルール
  - デプロイ手順

#### 11. 最適化・改善
- [ ] **パフォーマンス最適化**
  - Lambda関数の最適化
  - DynamoDBクエリ最適化
  - フロントエンド最適化

- [ ] **UI/UX改善**
  - デザイン調整
  - ユーザビリティ向上
  - アクセシビリティ対応

---

## 📊 タスク進捗サマリー

| カテゴリ | 完了 | 残り | 進捗率 |
|---------|------|------|--------|
| インフラ構築 | 4 | 0 | 100% |
| バックエンド実装 | 4 | 1 | 80% |
| フロントエンド実装 | 2 | 4 | 33% |
| AI処理実装 | 0 | 2 | 0% |
| 統合・テスト | 0 | 3 | 0% |
| ドキュメント | 5 | 0 | 100% |
| **合計** | **15** | **10** | **60%** |

---

## 🎯 次のマイルストーン

### Milestone 2: 基本機能実装完了（Week 3末目標）

**達成基準:**
- [x] auth関数の実装（LINE認証動作確認） ✅
- [x] award関数の実装 ✅
- [x] LIFFアプリの基本構造完成 ✅
- [x] LINEログイン機能動作確認 ✅
- [ ] GPS検証関数の実装
- [ ] API仕様書の完成

---

## 🔗 依存関係

```
1. auth関数の実装
   ↓
2. LIFFアプリ基本実装（ログイン機能）
   ↓
3. GPS/画像認識関数の実装
   ↓
4. award関数の実装
   ↓
5. 統合テスト
```

---

## ⚠️ ブロッカー・リスク

### 現在のブロッカー
- なし（DynamoDB実装完了済み）

### 潜在的なリスク
- LINE認証の依存ライブラリ問題（Docker環境でのビルドが必要）
- Rekognition APIの利用申請・承認待ち
- GPS精度の問題（実機テストが必要）

---

## 📝 次のアクション（今すぐ実施可能）

1. **LIFFアプリの基本構造作成**
   - index.html
   - app.js（LIFF初期化）
   - api.js（API呼び出し）
   - auth関数との統合テスト
   - award関数との統合テスト

2. **stamps関数の動作確認と改善**
   - テストデータ投入
   - エラーハンドリング追加

3. **GPS/画像認識関数の実装準備**
   - GPS検証関数の設計
   - 画像認識関数の設計

---

**更新日**: 現在
**次回レビュー**: 次のマイルストーン達成時

